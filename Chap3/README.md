# 第3章

## 演習 3.5.17

証明： `t ->* v`のとき、かつそのそきに限り `t \||/ v` が成り立つことを示せ。

memo:
`t \||/ v` は「項tは最終的な値vに評価される」ことを示す

方針： 命題1で必要条件を、命題2で十分条件を証明していく。

memo:
"p => q"  
qはpであるための必要条件  
pはqであるための十分条件

命題1： `t \||/ v ならば t ->* v`

`v \||/ v` (B-Value) の場合：

vの最終的な評価はvである。つまりvはvという当たり前な評価規則。

`t \||/ v` は `v \||/ v` と同等である場合を考えているため、t = v。  
よって `t ->* v`。

---

```
(t_1 \||/ true) (t_2 \||/ v_2)
-------------------------------(B-IfTrue) の場合：
if t_1 then t_2 else t_3 \||/ v_2

t = if t_1 then t_2 else t_3 のとき、
t_1 \||/ true
t_2 \||/ v
```

であり、`t_1 \||/ true` より、`t_1 ->* true` となる。

補題「`t_1 ->* t_1'` ならば `if t_1 then t_2 else t_3 ->*  t_1' then t_2 else t_3`」を利用して、
`if t_1 then t_2 else t_3 ->* if true then t_2 else t_3` となる。

E-IfTrueは `if t_1 then t_2 else t_3 -> t_2` であるから、帰納法の仮定 `t_2 \||/ v` より、`t_2 ->* v`。
よって `t ->* v`。

---

他も同様に示せる。

---

命題2： `t ->* v` ならば `t \||/ v`

`t ->* v` がゼロステップならば、t = v となり、B-Valueによって得られる。

---

`t = if t_1 then t_2 else t_3` の場合：

`t_1 ->* true` かつ `t_2 ->* v` (... (1)とする), `t_1 ->* false` かつ `t_3 ->* v` (... (2)とする) のどちらの場合もあるが、
ここでは(1)を考える。

`t_1 ->* true` かつ `t_2 ->* v` の評価ステップは tの評価ステップよりも短い。  
よって帰納法の仮定 `t_1 ->* true` かつ `t_2 ->* v` より、`t_1 \||/ true` と `t_2 \||/ v` が得られる。  
規則 B-IfTrue を用いて `t \||/ v`。

(2)についても同様。

---

命題1,2から証明「`t ->* v` のとき、かつそのそきに限り `t \||/ v` が成り立つ」ことを示した。
